## Кратко о задаче:

Оператор связи хочет бороться с оттоком клиентов. Для этого его сотрудники начнут предлагать промокоды и специальные условия всем, кто планирует отказаться от услуг связи.

Чтобы заранее находить таких пользователей, сервису нужна модель, которая будет предсказывать, разорвёт ли абонент договор.

Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и услугах.

**Задача** — обучить на этих данных модель для прогноза оттока клиентов.

***Требование*** — метрика ROC-AUC для финальной модели должна быть выше показателя в 0,85.

## Описание данных

Данные состоят из нескольких файлов, полученных из разных источников:

- *`contract_new.csv`* — информация о договоре;
- *`personal_new.csv`* — персональные данные клиента;
- *`internet_new.csv`* — информация об интернет-услугах;
- *`phone_new.csv`* — информация об услугах телефонии.

Файл *`contract_new.csv`*

- `customerID` — идентификатор абонента;
- `BeginDate` — дата начала действия договора;
- `EndDate` — дата окончания действия договора;
- `Type` — тип оплаты: раз в год-два или ежемесячно;
- `PaperlessBilling` — электронный расчётный лист;
- `PaymentMethod` — тип платежа;
- `MonthlyCharges` — расходы за месяц;
- `TotalCharges` — общие расходы абонента.

Файл *`personal_new.csv`*

- `customerID` — идентификатор пользователя;
- `gender` — пол;
- `SeniorCitizen` — является ли абонент пенсионером;
- `Partner` — есть ли у абонента супруг или супруга;
- `Dependents` — есть ли у абонента дети.

Файл *`internet_new.csv`*

- `customerID` — идентификатор пользователя;
- `InternetService` — тип подключения;
- `OnlineSecurity` — блокировка опасных сайтов;
- `OnlineBackup` — облачное хранилище файлов для резервного копирования данных;
- `DeviceProtection` — антивирус;
- `TechSupport` — выделенная линия технической поддержки;
- `StreamingTV` — стриминговое телевидение;
- `StreamingMovies` — каталог фильмов.

Файл *`phone_new.csv`*

- `customerID` — идентификатор пользователя;
- `MultipleLines` — подключение телефона к нескольким линиям одновременно.
## Инструменты
`Машинное обучение`, `Классификация`

***Библиотеки:***
*pandas, numpy, seaborn, matplotlib, scikit-learn, catboost, phik, optuna, shap*

## Выводы
1. Загружены и данные и выполнен их первичный осмотр.
2. Выполнен исследовательский анализ каждого датафрейма
3. Данные объеденены в один датафрейм.определены нюансы объедидения, выданны рекоммендации по исправлению возможных ошибок (заполнение пропусков, особенности форматов данных).
4. Выполнена перподготовка данных для обучения модели (составлен набор пайплайнов для числовых и категориальных признаков), составлен портрет уходящего клиента. Было определено что порядка 15,6% клиентов уже покинули компанию. В число признаков добавен признак длительности контракта и удалены признаки несущие в себе утечку.
5. Обучены три модели с помощью инструментов RandomSearchcV и Pipeline библиотеки библиотеки sklearn и выбранна одна основная - CatBoost. Для неё подобран первичный список оптимальнх гиперпараметров loss_function: Logloss, iterations: 350, depth: 5 Полученое значение метрики ROC AUC на кроссвалидации : 0.8631
6. Выполнен более тчательный подбор гиперпараметров с помощью инструментов библиотеки Optuna для выбранной модели, найдены оптимальные значения: Params: iterations: 587 learning_rate: 0.06663324681610823 depth: 4 l2_leaf_reg: 2.782378356442053e-07 bootstrap_type: Bayesian random_strength: 5.001652026366875e-07 bagging_temperature: 0.2712310349981021 od_type: IncToDec od_wait: 38 Полученое значение метрики ROC AUC на кроссвалидации : 0.9083
7. Проведена проверка модели на тестовой выборке и получено значение метрики ROC AUC = 0.9421.
8. Проанализированно влияния признаков на модель и констатировано отсутствие утечки целевого признака.
   
   Список используемых признаков для лучшей модели:
* Категориальные:
  * Type — тип оплаты;
  * PaperlessBilling — электронный расчётный лист;
  * PaymentMethod — тип платежа; gender — пол;
  * SeniorCitizen — является ли абонент пенсионером;
  * Partner — есть ли у абонента супруг или супруга;
  * Dependents — есть ли у абонента дети;
  * InternetService — тип подключения;
  * OnlineSecurity — блокировка опасных сайтов;
  * OnlineBackup — облачное хранилище файлов для резервного копирования данных;
  * DeviceProtection — антивирус;
  * TechSupport — выделенная линия технической поддержки;
  * StreamingTV — стриминговое телевидение;
  * StreamingMovies — каталог фильмов;
  * MultipleLines — подключение телефона к нескольким линиям одновременно.
  Предобработка: OrdinalEncoder(), SimpleImputer()

* Числовые:
  * MonthlyCharges — расходы за месяц;
  * TotalCharges — общие расходы абонента;
  * duration - длительность контракта (на текущий момент).
Предобработка:  нет

     общее число - 18
10. Модель рекомендована к использованию, как удовлетворяющая требованию заказчика.
